FROM php:7.3-fpm-alpine

RUN apk update
RUN apk add \
	autoconf \
	file \
	g++ \
	gcc \
	zlib-dev \
	libpng-dev \
	make \
	libmemcached-dev \
	libjpeg-turbo-dev \
	&& pecl install memcached \
	&& docker-php-ext-enable memcached
RUN pecl install xdebug-2.7.0RC2 \
	&& docker-php-ext-enable xdebug
RUN pecl install mongodb \
	&& docker-php-ext-enable mongodb
RUN docker-php-ext-install pdo_mysql
RUN docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \
	&& docker-php-ext-install gd

RUN apk add postfix
COPY docker/php/conf.ini .
RUN mv ./conf.ini $PHP_INI_DIR/conf.d/conf.ini
RUN echo "\nrelayhost = 192.241.188.88" >> /etc/postfix/main.cf

# RUN mv $PHP_INI_DIR/php.ini-production $PHP_INI_DIR/php.ini

WORKDIR /var/www
