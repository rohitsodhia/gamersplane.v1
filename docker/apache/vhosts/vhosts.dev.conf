<VirtualHost *:80>
	ServerName api.gamersplane.local
	DocumentRoot /var/www/api

	# ErrorLog "/var/log/gamersplane.api"
	# CustomLog "/var/log/gamersplane.api" common

	ProxyPassMatch ^/(.*\.php(/.*)?)$ fcgi://api:9000/var/www/api/$1
	ProxyPassReverse ^/(.*\.php(/.*)?)$ fcgi://api:9000/var/www/api/$1

	<Directory /var/www/api/>
		RewriteEngine On
		RewriteBase /
		RewriteRule !\.(css|jpg|js|gif|png|ico|eot|woff|woff2|ttff|svg|psd|html)$ dispatch.php

		Options FollowSymLinks
		Require all granted
	</Directory>

	<FilesMatch "\.(png|jp?g|gif|ico|mp4|wmv|mov|mpeg|css|map|woff?|eot|svg|ttf|js|json|pdf|csv)">
		ExpiresActive on
		ExpiresDefault "access plus 30 days"
	</FilesMatch>

	ErrorLog "|/usr/bin/cronolog /var/log/gamersplane/%Y/%m/%d/error.log"

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel notice

	CustomLog "|/usr/bin/cronolog /var/log/gamersplane/%Y/%m/%d/access.log" combined
</VirtualHost>


<VirtualHost *:80>
	ServerName gamersplane.local
	ServerAlias *.gamersplane.local
	DocumentRoot /var/www

	# ErrorLog "/var/log/gamersplane"
	# CustomLog "/var/log/gamersplane" common

	ProxyPreserveHost On
	ProxyPassMatch ^/(.*\.php(/.*)?)$ fcgi://api:9000/var/www/$1
	ProxyPassReverse ^/(.*\.php(/.*)?)$ fcgi://api:9000/var/www/$1

	<Directory /var/www/>
		RewriteEngine On
		RewriteBase /
		RewriteRule !\.(css|jpg|js|gif|png|ico|eot|woff|woff2|ttff|svg|psd|html)$ dispatch.php

		<FilesMatch "\.(png|jp?g|gif|ico|mp4|wmv|mov|mpeg|css|map|woff?|eot|svg|ttf|js|json|pdf|csv)">
			ExpiresActive on
			ExpiresDefault "access plus 30 days"
		</FilesMatch>

		Options FollowSymLinks
		Require all granted
	</Directory>

	ErrorLog "|/usr/bin/cronolog /var/log/gamersplane/%Y/%m/%d/error.log"

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel notice

	CustomLog "|/usr/bin/cronolog /var/log/gamersplane/%Y/%m/%d/access.log" combined
</VirtualHost>
